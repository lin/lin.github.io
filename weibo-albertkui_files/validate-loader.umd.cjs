(function(n,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(n=typeof globalThis<"u"?globalThis:n||self,o(n.ValidateLoader={}))})(this,(function(n){"use strict";class o{constructor(){this.scripts={geetest:"https://static.geetest.com/v4/gt4.js",yidun:"https://cstaticdun.126.net/load.min.js"},this.loadedScripts=new Map}load(i){const e=this.scripts[i]||i;if(this.loadedScripts.has(e))return this.loadedScripts.get(e);const t=new Promise((d,s)=>{const r=document.createElement("script");r.src=e,r.async=!0,r.onload=()=>{d()},r.onerror=l=>{this.loadedScripts.delete(e),s(new Error(`Failed to load script: ${e}`))},document.head.appendChild(r)});return this.loadedScripts.set(e,t),t}setConfig(i,e){this.scripts[i]=e}}const u=new o,c={GEETEST:"geetest",DUN:"yidun"};function p(a,i){return new Promise(e=>{if(a===c.GEETEST){if(typeof window.initGeetest!="function"){e({status:"error",data:new Error("Geetest script not loaded")});return}window.initGeetest({captcha_id:i.captcha_id||"YOUR_GT_ID",product:i.product||"bind"},t=>{t.onReady(()=>t.verify()),t.onSuccess(()=>{e({status:"success",data:{...t.getValidate(),captcha_id:i.captcha_id,validate_type:"geetest"}}),t.destroy(),t=null}),t.onError(d=>e({status:"error",data:d})),t.onClose(()=>{e({status:"close"}),t.destroy(),t=null})})}else if(a===c.DUN){if(typeof window.initNECaptcha!="function"){e({status:"error",data:new Error("NetEase Dun script not loaded")});return}let t;window.initNECaptcha({captchaId:i.captcha_id||"YOUR_DUN_ID",mode:i.mode||"popup",element:i.element,apiVersion:2,popupStyles:{position:"fixed"},onVerify:(d,s)=>{d||(t&&(t.destroy(),t=null),e({status:"success",data:{...s,captcha_id:i.captcha_id,validate_type:"yidun"}}))},onClose:()=>{t&&(t.destroy(),t=null),e({status:"close"})}},function(s){t=s,s.verify()},function(s){e({status:"error",data:s})})}else e({status:"error",data:new Error(`Unknown captcha type: ${a}`)})})}n.CAPTCHA_TYPE=c,n.dynamicLoader=u,n.handleCaptchaVerification=p,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
